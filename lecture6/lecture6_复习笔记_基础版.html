<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecture 6 å¤ä¹ ç¬”è®° - æƒ…æ„Ÿåˆ†æ</title>
    <style>
        body {
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
            line-height: 1.8;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #e74c3c;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-left: 4px solid #e74c3c;
            padding-left: 15px;
        }
        h3 {
            color: #555;
            margin-top: 20px;
        }
        h4 {
            color: #666;
        }
        code {
            background-color: #f8f8f8;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: "Courier New", Consolas, monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            line-height: 1.5;
        }
        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }
        blockquote {
            border-left: 4px solid #e74c3c;
            padding-left: 20px;
            margin-left: 0;
            color: #555;
            background-color: #f9f9f9;
            padding: 10px 20px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #e74c3c;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        hr {
            border: none;
            border-top: 2px solid #eee;
            margin: 30px 0;
        }
        details {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        summary {
            cursor: pointer;
            font-weight: bold;
            color: #e74c3c;
        }
        .formula {
            background-color: #f0f7ff;
            padding: 10px;
            border-left: 3px solid #3498db;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="lecture-6-sentiment-analysis">Lecture 6 è¶…åŸºç¡€å¤ä¹ ç¬”è®° - æƒ…æ„Ÿåˆ†æï¼ˆSentiment Analysisï¼‰</h1>
<h2 id="_1">é›¶ã€å…ˆç†è§£é—®é¢˜ï¼ˆä»€ä¹ˆæ˜¯æƒ…æ„Ÿåˆ†æï¼Ÿï¼‰</h2>
<h3 id="_2">ä»€ä¹ˆæ˜¯æƒ…æ„Ÿåˆ†æï¼Ÿ</h3>
<p><strong>å®šä¹‰ï¼š</strong>åˆ¤æ–­ä¸€æ®µæ–‡æœ¬è¡¨è¾¾çš„æƒ…æ„Ÿæ˜¯æ­£é¢ã€è´Ÿé¢è¿˜æ˜¯ä¸­æ€§</p>
<p><strong>ä¾‹å­ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">æ–‡æœ¬1</span><span class="err">ï¼š</span><span class="ss">&quot;I â¤ flying @VirginAmerica.&quot;</span>
<span class="n">æƒ…æ„Ÿ</span><span class="err">ï¼š</span><span class="n">æ­£é¢</span><span class="err">ï¼ˆ</span><span class="n">positive</span><span class="err">ï¼‰</span><span class="w"> </span><span class="err">âœ…</span>

<span class="n">æ–‡æœ¬2</span><span class="err">ï¼š</span><span class="ss">&quot;@SouthwestAir are you hiring for flight attendants right now?&quot;</span>
<span class="n">æƒ…æ„Ÿ</span><span class="err">ï¼š</span><span class="n">ä¸­æ€§</span><span class="err">ï¼ˆ</span><span class="n">neutral</span><span class="err">ï¼‰</span><span class="w"> </span><span class="err">ğŸ˜</span>

<span class="n">æ–‡æœ¬3</span><span class="err">ï¼š</span><span class="ss">&quot;@united I&#39;m rebooked now, but the line was 300 people deep.&quot;</span>
<span class="n">æƒ…æ„Ÿ</span><span class="err">ï¼š</span><span class="n">è´Ÿé¢</span><span class="err">ï¼ˆ</span><span class="n">negative</span><span class="err">ï¼‰</span><span class="w"> </span><span class="err">âŒ</span>
</code></pre></div>

<h3 id="_3">ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ</h3>
<p><strong>åº”ç”¨åœºæ™¯ï¼š</strong></p>
<ol>
<li>
<p><strong>å•†ä¸šåˆ†æ</strong>
   <code>åˆ†æå®¢æˆ·å¯¹äº§å“çš„è¯„ä»·
   â†’ äº†è§£äº§å“ä¼˜ç¼ºç‚¹
   â†’ æ”¹è¿›äº§å“å’ŒæœåŠ¡</code></p>
</li>
<li>
<p><strong>ç¤¾äº¤åª’ä½“ç›‘æ§</strong>
   <code>åˆ†æç”¨æˆ·å¯¹å“ç‰Œçš„æ€åº¦
   â†’ åŠæ—¶å‘ç°å…¬å…³å±æœº
   â†’ äº†è§£å¸‚åœºè¶‹åŠ¿</code></p>
</li>
<li>
<p><strong>æ”¿æ²»åˆ†æ</strong>
   <code>åˆ†æé€‰æ°‘å¯¹å€™é€‰äººçš„æƒ…æ„Ÿ
   â†’ é¢„æµ‹é€‰ä¸¾ç»“æœ</code></p>
</li>
</ol>
<hr />
<h2 id="lecture-6">ä¸€ã€Lecture 6çš„ä¸¤ç§æ–¹æ³•</h2>
<h3 id="1pmipointwise-mutual-information">æ–¹æ³•1ï¼šåŸºäºPMIï¼ˆPointwise Mutual Informationï¼‰</h3>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>çœ‹è¯è¯­å’Œç§¯æ/æ¶ˆæè¯çš„å…±ç°å…³ç³»</p>
<div class="codehilite"><pre><span></span><code>&quot;great&quot; ç»å¸¸å’Œç§¯æè¯ä¸€èµ·å‡ºç° â†’ ç§¯æ
&quot;terrible&quot; ç»å¸¸å’Œæ¶ˆæè¯ä¸€èµ·å‡ºç° â†’ æ¶ˆæ
</code></pre></div>

<hr />
<h3 id="2gradable-method">æ–¹æ³•2ï¼šåŸºäºè¯å…¸çš„å¯è¯„åˆ†æ–¹æ³•ï¼ˆGradable Methodï¼‰</h3>
<p><strong>æ ¸å¿ƒæ€æƒ³ï¼š</strong>æ¯ä¸ªè¯éƒ½æœ‰ä¸€ä¸ªæƒ…æ„Ÿåˆ†æ•°</p>
<div class="codehilite"><pre><span></span><code>&quot;love&quot; â†’ +3.5ï¼ˆå¾ˆç§¯æï¼‰
&quot;like&quot; â†’ +1.2ï¼ˆè¾ƒç§¯æï¼‰
&quot;hate&quot; â†’ -3.8ï¼ˆå¾ˆæ¶ˆæï¼‰

å¥å­æƒ…æ„Ÿåˆ†æ•° = æ‰€æœ‰è¯çš„åˆ†æ•°æ€»å’Œ
</code></pre></div>

<hr />
<h2 id="pmi">äºŒã€PMIæ–¹æ³•è¯¦è§£</h2>
<h3 id="1-pmi">1. PMIçš„å®šä¹‰</h3>
<p><strong>å…¬å¼ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>PMI(x, y) = logâ‚‚( P(x,y) / (P(x) Ã— P(y)) )

å…¶ä¸­ï¼š
- P(x,y) = xå’Œyå…±ç°çš„æ¦‚ç‡
- P(x) = xå‡ºç°çš„æ¦‚ç‡
- P(y) = yå‡ºç°çš„æ¦‚ç‡
</code></pre></div>

<p><strong>é€šä¿—ç†è§£ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>PMIè¡¡é‡ï¼šä¸¤ä¸ªè¯ä¸€èµ·å‡ºç°çš„é¢‘ç‡ï¼Œæ˜¯å¦é«˜äº&quot;éšæœº&quot;æƒ…å†µ

PMI &gt; 0ï¼šæ¯”éšæœºæƒ…å†µæ›´å¸¸ä¸€èµ·å‡ºç°ï¼ˆæ­£ç›¸å…³ï¼‰
PMI = 0ï¼šå’Œéšæœºæƒ…å†µä¸€æ ·ï¼ˆä¸ç›¸å…³ï¼‰
PMI &lt; 0ï¼šæ¯”éšæœºæƒ…å†µæ›´å°‘ä¸€èµ·å‡ºç°ï¼ˆè´Ÿç›¸å…³ï¼‰
</code></pre></div>

<hr />
<h3 id="2-pmi">2. ä¸ºä»€ä¹ˆç”¨PMIï¼Ÿ</h3>
<p><strong>é—®é¢˜ï¼š</strong>å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªè¯æ˜¯ç§¯æè¿˜æ˜¯æ¶ˆæï¼Ÿ</p>
<p><strong>ä¼ ç»Ÿæ–¹æ³•ï¼š</strong>äººå·¥æ ‡æ³¨è¯å…¸ï¼ˆè´¹æ—¶è´¹åŠ›ï¼‰</p>
<p><strong>PMIæ–¹æ³•ï¼š</strong>è‡ªåŠ¨ä»è¯­æ–™åº“å­¦ä¹ </p>
<div class="codehilite"><pre><span></span><code>æ­¥éª¤ï¼š
1. å‡†å¤‡ä¸€äº›æ˜ç¡®çš„ç§¯æè¯ï¼šlove, great, fantastic
2. å‡†å¤‡ä¸€äº›æ˜ç¡®çš„æ¶ˆæè¯ï¼šhate, bad, terrible
3. å¯¹äºä»»æ„è¯wï¼Œè®¡ç®—ï¼š
   - PMI(w, ç§¯æè¯)
   - PMI(w, æ¶ˆæè¯)
4. æ¯”è¾ƒä¸¤è€…ï¼Œåˆ¤æ–­wçš„ææ€§
</code></pre></div>

<p><strong>ä¾‹å­ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>è¯ï¼š&quot;excellent&quot;

è®¡ç®—ï¼š
PMI(&quot;excellent&quot;, &quot;love&quot;) = 2.5  â† é«˜
PMI(&quot;excellent&quot;, &quot;hate&quot;) = -1.2 â† ä½

ç»“è®ºï¼š&quot;excellent&quot; æ›´å€¾å‘äºç§¯æ
</code></pre></div>

<hr />
<h3 id="3">3. æ¦‚ç‡ä¼°è®¡ï¼ˆç”¨é¢‘ç‡ä»£æ›¿æ¦‚ç‡ï¼‰</h3>
<p><strong>ç†è®ºå…¬å¼ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>PMI(x, y) = logâ‚‚( P(x,y) / (P(x) Ã— P(y)) )
</code></pre></div>

<p><strong>å®é™…è®¡ç®—ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>P(x) â‰ˆ C(x) / N
P(y) â‰ˆ C(y) / N
P(x,y) â‰ˆ C(x,y) / N

å…¶ä¸­ï¼š
- C(x) = åŒ…å«è¯xçš„æ¨æ–‡æ•°é‡
- C(y) = åŒ…å«è¯yçš„æ¨æ–‡æ•°é‡
- C(x,y) = åŒæ—¶åŒ…å«xå’Œyçš„æ¨æ–‡æ•°é‡
- N = æ¨æ–‡æ€»æ•°
</code></pre></div>

<p><strong>ä»£å…¥ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>PMI(x, y) = logâ‚‚( (C(x,y)/N) / ((C(x)/N) Ã— (C(y)/N)) )
          = logâ‚‚( C(x,y) Ã— N / (C(x) Ã— C(y)) )
</code></pre></div>

<hr />
<h3 id="4">4. æ‰‹å·¥è®¡ç®—ç¤ºä¾‹</h3>
<p><strong>æ•°æ®ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>æ€»æ¨æ–‡æ•° N = 1000

&quot;love&quot; å‡ºç°åœ¨ 100 æ¡æ¨æ–‡ä¸­
&quot;JetBlue&quot; å‡ºç°åœ¨ 200 æ¡æ¨æ–‡ä¸­
&quot;love&quot; å’Œ &quot;JetBlue&quot; å…±ç°åœ¨ 50 æ¡æ¨æ–‡ä¸­
</code></pre></div>

<p><strong>è®¡ç®—ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>C(love) = 100
C(JetBlue) = 200
C(love, JetBlue) = 50
N = 1000

PMI(love, JetBlue) = logâ‚‚( 50 Ã— 1000 / (100 Ã— 200) )
                   = logâ‚‚( 50000 / 20000 )
                   = logâ‚‚( 2.5 )
                   â‰ˆ 1.32
</code></pre></div>

<p><strong>è§£é‡Šï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>PMI = 1.32 &gt; 0
â†’ &quot;love&quot; å’Œ &quot;JetBlue&quot; æ­£ç›¸å…³
â†’ &quot;JetBlue&quot; æœ‰ç§¯æå€¾å‘
</code></pre></div>

<hr />
<h3 id="5">5. ä»£ç å®ç°</h3>
<h4 id="1pmi">ç¬¬1æ­¥ï¼šå®šä¹‰PMIå‡½æ•°</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">PMI</span><span class="p">(</span><span class="n">c_xy</span><span class="p">,</span> <span class="n">c_x</span><span class="p">,</span> <span class="n">c_y</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    è®¡ç®—PMI(x, y)</span>

<span class="sd">    å‚æ•°ï¼š</span>
<span class="sd">    c_xyï¼šxå’Œyå…±ç°çš„æ¬¡æ•°</span>
<span class="sd">    c_xï¼šxå‡ºç°çš„æ¬¡æ•°</span>
<span class="sd">    c_yï¼šyå‡ºç°çš„æ¬¡æ•°</span>
<span class="sd">    Nï¼šæ€»è§‚æµ‹æ•°ï¼ˆæ¨æ–‡æ€»æ•°ï¼‰</span>

<span class="sd">    è¿”å›ï¼š</span>
<span class="sd">    PMIå€¼</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># è®¡ç®—æ¦‚ç‡</span>
    <span class="n">p_xy</span> <span class="o">=</span> <span class="n">c_xy</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">p_x</span> <span class="o">=</span> <span class="n">c_x</span> <span class="o">/</span> <span class="n">N</span>
    <span class="n">p_y</span> <span class="o">=</span> <span class="n">c_y</span> <span class="o">/</span> <span class="n">N</span>

    <span class="c1"># è®¡ç®—PMI</span>
    <span class="n">pmi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span> <span class="n">p_xy</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_x</span> <span class="o">*</span> <span class="n">p_y</span><span class="p">)</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">pmi</span>
</code></pre></div>

<p><strong>è¯¦ç»†è§£é‡Šï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># ä¾‹å­æ•°æ®</span>
<span class="n">c_xy</span> <span class="o">=</span> <span class="mi">50</span>   <span class="c1"># loveå’ŒJetBlueå…±ç°50æ¬¡</span>
<span class="n">c_x</span> <span class="o">=</span> <span class="mi">100</span>   <span class="c1"># loveå‡ºç°100æ¬¡</span>
<span class="n">c_y</span> <span class="o">=</span> <span class="mi">200</span>   <span class="c1"># JetBlueå‡ºç°200æ¬¡</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>    <span class="c1"># æ€»å…±1000æ¡æ¨æ–‡</span>

<span class="c1"># è®¡ç®—æ¦‚ç‡</span>
<span class="n">p_xy</span> <span class="o">=</span> <span class="mi">50</span> <span class="o">/</span> <span class="mi">1000</span> <span class="o">=</span> <span class="mf">0.05</span>      <span class="c1"># å…±ç°æ¦‚ç‡</span>
<span class="n">p_x</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="mi">1000</span> <span class="o">=</span> <span class="mf">0.1</span>       <span class="c1"># loveæ¦‚ç‡</span>
<span class="n">p_y</span> <span class="o">=</span> <span class="mi">200</span> <span class="o">/</span> <span class="mi">1000</span> <span class="o">=</span> <span class="mf">0.2</span>       <span class="c1"># JetBlueæ¦‚ç‡</span>

<span class="c1"># è®¡ç®—PMI</span>
<span class="n">pmi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span> <span class="mf">0.05</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.1</span> <span class="o">*</span> <span class="mf">0.2</span><span class="p">)</span> <span class="p">)</span>
    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span> <span class="mf">0.05</span> <span class="o">/</span> <span class="mf">0.02</span> <span class="p">)</span>
    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span> <span class="mf">2.5</span> <span class="p">)</span>
    <span class="o">=</span> <span class="mf">1.32</span>
</code></pre></div>

<hr />
<h4 id="2">ç¬¬2æ­¥ï¼šç»Ÿè®¡è¯é¢‘</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>

<span class="c1"># å‡ºç°æ¬¡æ•°ç»Ÿè®¡</span>
<span class="n">occ_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>

<span class="c1"># å…±ç°æ¬¡æ•°ç»Ÿè®¡ï¼ˆä¸¤å±‚å­—å…¸ï¼‰</span>
<span class="n">cooc_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span>

<span class="c1"># ç§¯æè¯åˆ—è¡¨</span>
<span class="n">pos_words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;love&quot;</span><span class="p">,</span> <span class="s2">&quot;great&quot;</span><span class="p">,</span> <span class="s2">&quot;like&quot;</span><span class="p">]</span>

<span class="c1"># æ¶ˆæè¯åˆ—è¡¨</span>
<span class="n">neg_words</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;hate&quot;</span><span class="p">,</span> <span class="s2">&quot;bad&quot;</span><span class="p">,</span> <span class="s2">&quot;annoy&quot;</span><span class="p">]</span>

<span class="c1"># ç›®æ ‡å…¬å¸åˆ—è¡¨</span>
<span class="n">companies</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;@virginamerica&quot;</span><span class="p">,</span> <span class="s2">&quot;@united&quot;</span><span class="p">,</span> <span class="s2">&quot;@southwestair&quot;</span><span class="p">]</span>

<span class="c1"># æƒ…æ„Ÿè¯ = ç§¯æè¯ + æ¶ˆæè¯</span>
<span class="n">sentiment_words</span> <span class="o">=</span> <span class="n">pos_words</span> <span class="o">+</span> <span class="n">neg_words</span>
</code></pre></div>

<p><strong>æ•°æ®ç»“æ„è§£é‡Šï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># occ_countsï¼šå•ä¸ªè¯çš„å‡ºç°æ¬¡æ•°</span>
<span class="n">occ_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
<span class="c1"># ä¾‹å¦‚ï¼š</span>
<span class="c1"># occ_counts[&#39;love&#39;] = 100</span>
<span class="c1"># occ_counts[&#39;@jetblue&#39;] = 200</span>

<span class="c1"># cooc_countsï¼šå…±ç°æ¬¡æ•°ï¼ˆä¸¤å±‚å­—å…¸ï¼‰</span>
<span class="n">cooc_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span>
<span class="c1"># ç¬¬1å±‚ï¼šå…¬å¸å</span>
<span class="c1"># ç¬¬2å±‚ï¼šæƒ…æ„Ÿè¯ â†’ å…±ç°æ¬¡æ•°</span>
<span class="c1"># ä¾‹å¦‚ï¼š</span>
<span class="c1"># cooc_counts[&#39;@jetblue&#39;][&#39;love&#39;] = 50</span>
<span class="c1"># cooc_counts[&#39;@jetblue&#39;][&#39;hate&#39;] = 10</span>
</code></pre></div>

<hr />
<h4 id="3_1">ç¬¬3æ­¥ï¼šç»Ÿè®¡æ•°æ®</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># è¯»å–CSVæ–‡ä»¶</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;Tweets_short.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># è½¬å°å†™</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="c1"># æ€»æ¨æ–‡æ•°</span>
<span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># éå†æ¯æ¡æ¨æ–‡</span>
<span class="k">for</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># åˆ†è¯ï¼ˆå»é‡ï¼‰</span>
    <span class="n">words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tweet</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

    <span class="c1"># ç»Ÿè®¡æ‰€æœ‰è¯çš„å‡ºç°æ¬¡æ•°</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="n">occ_counts</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="c1"># åªç»Ÿè®¡å…¬å¸å’Œæƒ…æ„Ÿè¯çš„å…±ç°</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">companies</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">word2</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">word2</span> <span class="ow">in</span> <span class="n">sentiment_words</span><span class="p">:</span>
                    <span class="n">cooc_counts</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="n">word2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</code></pre></div>

<p><strong>è¯¦ç»†è§£é‡Šï¼š</strong></p>
<p><strong>ä¸ºä»€ä¹ˆç”¨ <code>set()</code>ï¼Ÿ</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">tweet</span> <span class="o">=</span> <span class="s2">&quot;I love love love @jetblue&quot;</span>
<span class="n">words_list</span> <span class="o">=</span> <span class="n">tweet</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># [&#39;I&#39;, &#39;love&#39;, &#39;love&#39;, &#39;love&#39;, &#39;@jetblue&#39;]</span>
<span class="n">words_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">words_list</span><span class="p">)</span>  <span class="c1"># {&#39;I&#39;, &#39;love&#39;, &#39;@jetblue&#39;}</span>

<span class="c1"># ç”¨setå»é‡çš„åŸå› ï¼š</span>
<span class="c1"># æˆ‘ä»¬åªå…³å¿ƒ&quot;love&quot;å’Œ&quot;@jetblue&quot;æ˜¯å¦åœ¨åŒä¸€æ¡æ¨æ–‡ä¸­</span>
<span class="c1"># ä¸å…³å¿ƒ&quot;love&quot;å‡ºç°äº†å‡ æ¬¡</span>
</code></pre></div>

<p><strong>ç»Ÿè®¡é€»è¾‘ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># å‡è®¾æ¨æ–‡ï¼š&quot;I love @jetblue it&#39;s great&quot;</span>
<span class="n">words</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="s1">&#39;@jetblue&#39;</span><span class="p">,</span> <span class="s2">&quot;it&#39;s&quot;</span><span class="p">,</span> <span class="s1">&#39;great&#39;</span><span class="p">}</span>

<span class="c1"># ç¬¬1ä¸ªå¾ªç¯ï¼šç»Ÿè®¡æ‰€æœ‰è¯çš„å‡ºç°</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
    <span class="n">occ_counts</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1"># ç»“æœï¼š</span>
<span class="c1"># occ_counts[&#39;i&#39;] += 1</span>
<span class="c1"># occ_counts[&#39;love&#39;] += 1</span>
<span class="c1"># occ_counts[&#39;@jetblue&#39;] += 1</span>
<span class="c1"># occ_counts[&quot;it&#39;s&quot;] += 1</span>
<span class="c1"># occ_counts[&#39;great&#39;] += 1</span>

<span class="c1"># ç¬¬2ä¸ªå¾ªç¯ï¼šç»Ÿè®¡å…±ç°</span>
<span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">companies</span><span class="p">:</span>  <span class="c1"># åªå¤„ç†å…¬å¸å</span>
        <span class="c1"># word = &#39;@jetblue&#39;</span>
        <span class="k">for</span> <span class="n">word2</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">word2</span> <span class="ow">in</span> <span class="n">sentiment_words</span><span class="p">:</span>  <span class="c1"># åªå¤„ç†æƒ…æ„Ÿè¯</span>
                <span class="c1"># word2 = &#39;love&#39; æˆ– &#39;great&#39;</span>
                <span class="n">cooc_counts</span><span class="p">[</span><span class="n">word</span><span class="p">][</span><span class="n">word2</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># ç»“æœï¼š</span>
<span class="c1"># cooc_counts[&#39;@jetblue&#39;][&#39;love&#39;] += 1</span>
<span class="c1"># cooc_counts[&#39;@jetblue&#39;][&#39;great&#39;] += 1</span>
</code></pre></div>

<hr />
<h4 id="4pmi">ç¬¬4æ­¥ï¼šè®¡ç®—PMIå¹¶åˆ¤æ–­æƒ…æ„Ÿ</h4>
<div class="codehilite"><pre><span></span><code><span class="c1"># å¯¹æ¯ä¸ªå…¬å¸</span>
<span class="k">for</span> <span class="n">company</span> <span class="ow">in</span> <span class="n">companies</span><span class="p">:</span>
    <span class="n">company_count</span> <span class="o">=</span> <span class="n">occ_counts</span><span class="p">[</span><span class="n">company</span><span class="p">]</span>

    <span class="c1"># å­˜å‚¨ç§¯æPMIå’Œæ¶ˆæPMI</span>
    <span class="n">posPMIs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">negPMIs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># è®¡ç®—å’Œç§¯æè¯çš„PMI</span>
    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">pos_words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">cooc_counts</span><span class="p">[</span><span class="n">company</span><span class="p">]:</span>  <span class="c1"># æ£€æŸ¥æ˜¯å¦å…±ç°</span>
            <span class="n">pmi</span> <span class="o">=</span> <span class="n">PMI</span><span class="p">(</span><span class="n">cooc_counts</span><span class="p">[</span><span class="n">company</span><span class="p">][</span><span class="n">pos</span><span class="p">],</span>
                     <span class="n">company_count</span><span class="p">,</span>
                     <span class="n">occ_counts</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span>
                     <span class="n">N</span><span class="p">)</span>
            <span class="n">posPMIs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmi</span><span class="p">)</span>

    <span class="c1"># è®¡ç®—å’Œæ¶ˆæè¯çš„PMI</span>
    <span class="k">for</span> <span class="n">neg</span> <span class="ow">in</span> <span class="n">neg_words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">neg</span> <span class="ow">in</span> <span class="n">cooc_counts</span><span class="p">[</span><span class="n">company</span><span class="p">]:</span>
            <span class="n">pmi</span> <span class="o">=</span> <span class="n">PMI</span><span class="p">(</span><span class="n">cooc_counts</span><span class="p">[</span><span class="n">company</span><span class="p">][</span><span class="n">neg</span><span class="p">],</span>
                     <span class="n">company_count</span><span class="p">,</span>
                     <span class="n">occ_counts</span><span class="p">[</span><span class="n">neg</span><span class="p">],</span>
                     <span class="n">N</span><span class="p">)</span>
            <span class="n">negPMIs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pmi</span><span class="p">)</span>

    <span class="c1"># è®¡ç®—å¹³å‡PMI</span>
    <span class="n">avg_pos</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">posPMIs</span><span class="p">)</span>
    <span class="n">avg_neg</span> <span class="o">=</span> <span class="n">mean</span><span class="p">(</span><span class="n">negPMIs</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">company</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">avg_pos</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (pos), </span><span class="si">{</span><span class="n">avg_neg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (neg)&quot;</span><span class="p">)</span>
</code></pre></div>

<p><strong>æ‰§è¡Œç¤ºä¾‹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># å‡è®¾æ•°æ®ï¼š</span>
<span class="n">company</span> <span class="o">=</span> <span class="s1">&#39;@jetblue&#39;</span>
<span class="n">occ_counts</span><span class="p">[</span><span class="s1">&#39;@jetblue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>

<span class="n">pos_words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="s1">&#39;great&#39;</span><span class="p">,</span> <span class="s1">&#39;like&#39;</span><span class="p">]</span>
<span class="n">occ_counts</span><span class="p">[</span><span class="s1">&#39;love&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">occ_counts</span><span class="p">[</span><span class="s1">&#39;great&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">occ_counts</span><span class="p">[</span><span class="s1">&#39;like&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>

<span class="n">cooc_counts</span><span class="p">[</span><span class="s1">&#39;@jetblue&#39;</span><span class="p">][</span><span class="s1">&#39;love&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">cooc_counts</span><span class="p">[</span><span class="s1">&#39;@jetblue&#39;</span><span class="p">][</span><span class="s1">&#39;great&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">cooc_counts</span><span class="p">[</span><span class="s1">&#39;@jetblue&#39;</span><span class="p">][</span><span class="s1">&#39;like&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="c1"># è®¡ç®—PMI</span>
<span class="n">PMI_love</span> <span class="o">=</span> <span class="n">PMI</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
         <span class="o">=</span> <span class="n">log</span><span class="err">â‚‚</span><span class="p">(</span><span class="mi">50</span> <span class="err">Ã—</span> <span class="mi">1000</span> <span class="o">/</span> <span class="p">(</span><span class="mi">200</span> <span class="err">Ã—</span> <span class="mi">100</span><span class="p">))</span>
         <span class="o">=</span> <span class="n">log</span><span class="err">â‚‚</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>
         <span class="o">=</span> <span class="mf">1.32</span>

<span class="n">PMI_great</span> <span class="o">=</span> <span class="n">PMI</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
          <span class="o">=</span> <span class="n">log</span><span class="err">â‚‚</span><span class="p">(</span><span class="mi">30</span> <span class="err">Ã—</span> <span class="mi">1000</span> <span class="o">/</span> <span class="p">(</span><span class="mi">200</span> <span class="err">Ã—</span> <span class="mi">80</span><span class="p">))</span>
          <span class="o">=</span> <span class="n">log</span><span class="err">â‚‚</span><span class="p">(</span><span class="mf">1.875</span><span class="p">)</span>
          <span class="o">=</span> <span class="mf">0.91</span>

<span class="n">PMI_like</span> <span class="o">=</span> <span class="n">PMI</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
         <span class="o">=</span> <span class="n">log</span><span class="err">â‚‚</span><span class="p">(</span><span class="mi">60</span> <span class="err">Ã—</span> <span class="mi">1000</span> <span class="o">/</span> <span class="p">(</span><span class="mi">200</span> <span class="err">Ã—</span> <span class="mi">150</span><span class="p">))</span>
         <span class="o">=</span> <span class="n">log</span><span class="err">â‚‚</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
         <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># å¹³å‡PMI</span>
<span class="n">avg_pos</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.32</span> <span class="o">+</span> <span class="mf">0.91</span> <span class="o">+</span> <span class="mf">1.0</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3</span> <span class="o">=</span> <span class="mf">1.08</span>

<span class="c1"># åŒæ ·è®¡ç®—neg_wordsçš„PMI...</span>
<span class="n">avg_neg</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># è¾“å‡º</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;@jetblue: 1.08 (pos), -0.5 (neg)&quot;</span><span class="p">)</span>
<span class="c1"># ç»“è®ºï¼š@jetblueæ•´ä½“åå‘ç§¯æï¼ˆ1.08 &gt; -0.5ï¼‰</span>
</code></pre></div>

<hr />
<h3 id="6-pmi">6. PMIçš„æ„ä¹‰</h3>
<p><strong>PMIå€¼çš„è§£é‡Šï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>PMI &gt; 0ï¼šæ­£ç›¸å…³
  â†’ ä¸¤ä¸ªè¯ä¸€èµ·å‡ºç°çš„é¢‘ç‡ï¼Œé«˜äºéšæœºæƒ…å†µ
  â†’ æœ‰æŸç§è”ç³»

PMI = 0ï¼šä¸ç›¸å…³
  â†’ ä¸¤ä¸ªè¯ä¸€èµ·å‡ºç°çš„é¢‘ç‡ï¼Œç­‰äºéšæœºæƒ…å†µ
  â†’ æ²¡æœ‰ç‰¹æ®Šè”ç³»

PMI &lt; 0ï¼šè´Ÿç›¸å…³
  â†’ ä¸¤ä¸ªè¯ä¸€èµ·å‡ºç°çš„é¢‘ç‡ï¼Œä½äºéšæœºæƒ…å†µ
  â†’ äº’ç›¸æ’æ–¥
</code></pre></div>

<p><strong>åœ¨æƒ…æ„Ÿåˆ†æä¸­ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>PMI(å…¬å¸, ç§¯æè¯) é«˜ â†’ å…¬å¸è¯„ä»·ç§¯æ
PMI(å…¬å¸, æ¶ˆæè¯) é«˜ â†’ å…¬å¸è¯„ä»·æ¶ˆæ

æ¯”è¾ƒä¸¤è€…çš„å¹³å‡å€¼ï¼Œåˆ¤æ–­æ•´ä½“æƒ…æ„Ÿ
</code></pre></div>

<hr />
<h2 id="gradable-method">ä¸‰ã€å¯è¯„åˆ†æ–¹æ³•ï¼ˆGradable Methodï¼‰</h2>
<h3 id="1">1. æ ¸å¿ƒæ€æƒ³</h3>
<p><strong>æ–¹æ³•ï¼š</strong>ç»™æ¯ä¸ªè¯åˆ†é…ä¸€ä¸ªæƒ…æ„Ÿåˆ†æ•°</p>
<div class="codehilite"><pre><span></span><code>èŒƒå›´ï¼š-4ï¼ˆæåº¦æ¶ˆæï¼‰åˆ° +4ï¼ˆæåº¦ç§¯æï¼‰

ä¾‹å­ï¼š
&quot;excellent&quot; â†’ +3.5
&quot;good&quot;      â†’ +2.0
&quot;ok&quot;        â†’ +0.5
&quot;bad&quot;       â†’ -2.0
&quot;terrible&quot;  â†’ -3.5
</code></pre></div>

<p><strong>å¥å­æƒ…æ„Ÿï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>å¥å­æƒ…æ„Ÿåˆ†æ•° = Î£ æ¯ä¸ªè¯çš„æƒ…æ„Ÿåˆ†æ•°

ä¾‹å¦‚ï¼š
&quot;The food is excellent&quot;
= 0 + 0 + 0 + 3.5  ï¼ˆåªæœ‰&quot;excellent&quot;æœ‰åˆ†æ•°ï¼‰
= 3.5ï¼ˆç§¯æï¼‰

&quot;The service is bad&quot;
= 0 + 0 + 0 + (-2.0)
= -2.0ï¼ˆæ¶ˆæï¼‰
</code></pre></div>

<hr />
<h3 id="2-valence-lexicon">2. æƒ…æ„Ÿè¯å…¸ï¼ˆValence Lexiconï¼‰</h3>
<p><strong>æ¥æºï¼š</strong>äººå·¥æ ‡æ³¨</p>
<div class="codehilite"><pre><span></span><code>æ–¹æ³•ï¼š
1. è®©10ä¸ªäººå¯¹æ¯ä¸ªè¯æ‰“åˆ†ï¼ˆ-4åˆ°+4ï¼‰
2. å–å¹³å‡å€¼ä½œä¸ºè¯¥è¯çš„æƒ…æ„Ÿåˆ†æ•°
</code></pre></div>

<p><strong>æ–‡ä»¶æ ¼å¼ï¼š</strong><code>valence_lexicon_small.tsv</code></p>
<div class="codehilite"><pre><span></span><code>word        Valence
love        3.06
good        2.52
great       3.32
hate        -2.79
bad         -2.90
terrible    -3.42
</code></pre></div>

<p><strong>è¯»å–ä»£ç ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># è¯»å–TSVæ–‡ä»¶</span>
<span class="n">valence</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;valence_lexicon_small.tsv&quot;</span><span class="p">,</span>
                      <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span>
                      <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="s1">&#39;Valence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>

<span class="c1"># ç»“æœæ˜¯å­—å…¸</span>
<span class="c1"># valence = {</span>
<span class="c1">#     &#39;love&#39;: 3.06,</span>
<span class="c1">#     &#39;good&#39;: 2.52,</span>
<span class="c1">#     &#39;great&#39;: 3.32,</span>
<span class="c1">#     &#39;hate&#39;: -2.79,</span>
<span class="c1">#     ...</span>
<span class="c1"># }</span>
</code></pre></div>

<hr />
<h3 id="3_2">3. åŸºç¡€ç®—æ³•</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">classify_sentiment_basic</span><span class="p">(</span><span class="n">tweet</span><span class="p">,</span> <span class="n">valence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    åŸºç¡€æƒ…æ„Ÿåˆ†ç±»</span>

<span class="sd">    å‚æ•°ï¼š</span>
<span class="sd">    tweetï¼šæ¨æ–‡æ–‡æœ¬</span>
<span class="sd">    valenceï¼šæƒ…æ„Ÿè¯å…¸ï¼ˆå­—å…¸ï¼‰</span>

<span class="sd">    è¿”å›ï¼š</span>
<span class="sd">    &#39;positive&#39;, &#39;neutral&#39;, æˆ– &#39;negative&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># åˆ†è¯</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">tweet</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="c1"># ç´¯åŠ æƒ…æ„Ÿåˆ†æ•°</span>
    <span class="n">tweet_valence</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">valence</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">valence</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

    <span class="c1"># æ ¹æ®é˜ˆå€¼åˆ†ç±»</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.05</span>

    <span class="k">if</span> <span class="n">tweet_valence</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;positive&#39;</span>
    <span class="k">elif</span> <span class="n">tweet_valence</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">threshold</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;negative&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;neutral&#39;</span>
</code></pre></div>

<p><strong>æ‰§è¡Œç¤ºä¾‹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">tweet</span> <span class="o">=</span> <span class="s2">&quot;I love this airline it&#39;s great&quot;</span>
<span class="n">valence</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;love&#39;</span><span class="p">:</span> <span class="mf">3.06</span><span class="p">,</span>
    <span class="s1">&#39;great&#39;</span><span class="p">:</span> <span class="mf">3.32</span><span class="p">,</span>
    <span class="c1"># ... å…¶ä»–è¯</span>
<span class="p">}</span>

<span class="c1"># åˆ†è¯</span>
<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="s1">&#39;this&#39;</span><span class="p">,</span> <span class="s1">&#39;airline&#39;</span><span class="p">,</span> <span class="s2">&quot;it&#39;s&quot;</span><span class="p">,</span> <span class="s1">&#39;great&#39;</span><span class="p">]</span>

<span class="c1"># ç´¯åŠ </span>
<span class="n">tweet_valence</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># &#39;i&#39; ä¸åœ¨è¯å…¸ â†’ è·³è¿‡</span>
<span class="c1"># &#39;love&#39; åœ¨è¯å…¸ â†’ tweet_valence += 3.06</span>
<span class="n">tweet_valence</span> <span class="o">=</span> <span class="mf">3.06</span>
<span class="c1"># &#39;this&#39; ä¸åœ¨è¯å…¸ â†’ è·³è¿‡</span>
<span class="c1"># &#39;airline&#39; ä¸åœ¨è¯å…¸ â†’ è·³è¿‡</span>
<span class="c1"># &quot;it&#39;s&quot; ä¸åœ¨è¯å…¸ â†’ è·³è¿‡</span>
<span class="c1"># &#39;great&#39; åœ¨è¯å…¸ â†’ tweet_valence += 3.32</span>
<span class="n">tweet_valence</span> <span class="o">=</span> <span class="mf">3.06</span> <span class="o">+</span> <span class="mf">3.32</span> <span class="o">=</span> <span class="mf">6.38</span>

<span class="c1"># åˆ†ç±»</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="mf">6.38</span> <span class="o">&gt;</span> <span class="mf">0.05</span>  <span class="c1"># True</span>
<span class="err">â†’</span> <span class="s1">&#39;positive&#39;</span>
</code></pre></div>

<hr />
<h3 id="4-threshold">4. é˜ˆå€¼ï¼ˆThresholdï¼‰çš„ä½œç”¨</h3>
<p><strong>é—®é¢˜ï¼š</strong>æƒ…æ„Ÿåˆ†æ•°æ¥è¿‘0æ—¶å¦‚ä½•åˆ†ç±»ï¼Ÿ</p>
<div class="codehilite"><pre><span></span><code>ä¾‹å­ï¼š
tweet_valence = 0.01  â† å‡ ä¹æ˜¯ä¸­æ€§ï¼Œä½†ç¨å¾®ç§¯æ
åº”è¯¥åˆ†ç±»ä¸º &#39;positive&#39; è¿˜æ˜¯ &#39;neutral&#39;ï¼Ÿ
</code></pre></div>

<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>è®¾ç½®é˜ˆå€¼</p>
<div class="codehilite"><pre><span></span><code><span class="nv">threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>.<span class="mi">05</span>

<span class="k">if</span><span class="w"> </span><span class="nv">valence</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="o">+</span><span class="mi">0</span>.<span class="mi">05</span>:
<span class="w">    </span>â†’<span class="w"> </span><span class="nv">positive</span>
<span class="nv">elif</span><span class="w"> </span><span class="nv">valence</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="o">-</span><span class="mi">0</span>.<span class="mi">05</span>:
<span class="w">    </span>â†’<span class="w"> </span><span class="nv">negative</span>
<span class="k">else</span>:<span class="w">  </span>#<span class="w"> </span><span class="o">-</span><span class="mi">0</span>.<span class="mi">05</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="nv">valence</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="o">+</span><span class="mi">0</span>.<span class="mi">05</span>
<span class="w">    </span>â†’<span class="w"> </span><span class="nv">neutral</span>
</code></pre></div>

<p><strong>å›¾ç¤ºï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>        -0.05        0        +0.05
  --------|----------|----------|--------
  negative  neutral    neutral   positive
  â†â”€â”€â”€â”€â”€â”€â”€â”€|â†â”€â”€â”€â”€â”€â”€â”€â”€â†’|â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’
</code></pre></div>

<p><strong>é˜ˆå€¼çš„å½±å“ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>threshold = 0.01ï¼ˆå°é˜ˆå€¼ï¼‰
â†’ neutralèŒƒå›´çª„
â†’ æ›´å¤šæ¨æ–‡è¢«åˆ†ç±»ä¸ºpositive/negative
â†’ åˆ†ç±»æ›´&quot;æ•æ„Ÿ&quot;

threshold = 1.0ï¼ˆå¤§é˜ˆå€¼ï¼‰
â†’ neutralèŒƒå›´å®½
â†’ æ›´å¤šæ¨æ–‡è¢«åˆ†ç±»ä¸ºneutral
â†’ åˆ†ç±»æ›´&quot;ä¿å®ˆ&quot;
</code></pre></div>

<hr />
<h3 id="5_1">5. é«˜çº§ç‰¹æ€§</h3>
<h4 id="1_1">ç‰¹æ€§1ï¼šå¦å®šè¯å¤„ç†</h4>
<p><strong>é—®é¢˜ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>&quot;I love this&quot;        â†’ positive âœ…
&quot;I don&#39;t love this&quot;  â†’ ä¹Ÿæ˜¯positiveï¼ŸâŒï¼ˆé”™äº†ï¼ï¼‰
</code></pre></div>

<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong>è¯†åˆ«å¦å®šè¯ï¼Œåè½¬æƒ…æ„Ÿ</p>
<div class="codehilite"><pre><span></span><code><span class="n">negation_words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;not&#39;</span><span class="p">,</span> <span class="s2">&quot;don&#39;t&quot;</span><span class="p">,</span> <span class="s2">&quot;didn&#39;t&quot;</span><span class="p">,</span> <span class="s2">&quot;never&quot;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">]</span>

<span class="c1"># ä¿®æ”¹ç®—æ³•</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">valence</span><span class="p">:</span>
        <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">valence</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">negation_words</span><span class="p">:</span>
        <span class="n">tweet_valence</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">0.8</span>  <span class="c1"># åè½¬å¹¶å‡å¼±</span>
</code></pre></div>

<p><strong>ä¾‹å­ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">tweet</span> <span class="o">=</span> <span class="s2">&quot;I don&#39;t love this&quot;</span>
<span class="n">words</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="s2">&quot;don&#39;t&quot;</span><span class="p">,</span> <span class="s1">&#39;love&#39;</span><span class="p">,</span> <span class="s1">&#39;this&#39;</span><span class="p">]</span>

<span class="n">tweet_valence</span> <span class="o">=</span> <span class="mi">0</span>
<span class="c1"># &#39;i&#39; â†’ è·³è¿‡</span>
<span class="c1"># &quot;don&#39;t&quot; â†’ å¦å®šè¯</span>
<span class="n">tweet_valence</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">0.8</span>  <span class="c1"># 0 * -0.8 = 0</span>
<span class="c1"># &#39;love&#39; â†’ valence[&#39;love&#39;] = 3.06</span>
<span class="n">tweet_valence</span> <span class="o">+=</span> <span class="mf">3.06</span>  <span class="c1"># 0 + 3.06 = 3.06</span>
<span class="c1"># ä½†å‰é¢æœ‰å¦å®šè¯ï¼Œæœ€ç»ˆåº”è¯¥æ˜¯è´Ÿçš„</span>

<span class="c1"># æ›´å¥½çš„å®ç°ï¼š</span>
<span class="n">tweet_valence</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">negation_flag</span> <span class="o">=</span> <span class="kc">False</span>
<span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">negation_words</span><span class="p">:</span>
        <span class="n">negation_flag</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">valence</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">negation_flag</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="o">-</span><span class="n">valence</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.8</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">valence</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

<span class="c1"># ç»“æœï¼š</span>
<span class="c1"># &quot;don&#39;t&quot; â†’ negation_flag = True</span>
<span class="c1"># &#39;love&#39; â†’ tweet_valence += -3.06 * 0.8 = -2.45</span>
<span class="c1"># æœ€ç»ˆï¼štweet_valence = -2.45ï¼ˆè´Ÿé¢ï¼‰âœ…</span>
</code></pre></div>

<hr />
<h4 id="2strengthening-words">ç‰¹æ€§2ï¼šåŠ å¼ºè¯ï¼ˆStrengthening Wordsï¼‰</h4>
<p><strong>ä½œç”¨ï¼š</strong>å¢å¼ºæƒ…æ„Ÿå¼ºåº¦</p>
<div class="codehilite"><pre><span></span><code>&quot;good&quot;      â†’ +2.0
&quot;very good&quot; â†’ +2.0 + 0.5 = +2.5ï¼ˆæ›´ç§¯æï¼‰
</code></pre></div>

<p><strong>åŠ å¼ºè¯åˆ—è¡¨ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">strengthen_words</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;very&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;really&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;extremely&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="s1">&#39;absolutely&#39;</span><span class="p">:</span> <span class="mf">0.8</span>
<span class="p">}</span>
</code></pre></div>

<p><strong>ç®—æ³•ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">valence</span><span class="p">:</span>
        <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">valence</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">strengthen_words</span><span class="p">:</span>
        <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">strengthen_words</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
</code></pre></div>

<hr />
<h4 id="3weakening-words">ç‰¹æ€§3ï¼šå‡å¼±è¯ï¼ˆWeakening Wordsï¼‰</h4>
<p><strong>ä½œç”¨ï¼š</strong>å‡å¼±æƒ…æ„Ÿå¼ºåº¦</p>
<div class="codehilite"><pre><span></span><code>&quot;good&quot;          â†’ +2.0
&quot;somewhat good&quot; â†’ +2.0 - 0.3 = +1.7ï¼ˆè¾ƒä¸ç§¯æï¼‰
</code></pre></div>

<p><strong>å‡å¼±è¯åˆ—è¡¨ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">weaken_words</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;somewhat&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="s1">&#39;slightly&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="s1">&#39;barely&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h4 id="4_1">ç‰¹æ€§4ï¼šæ„Ÿå¹å·</h4>
<p><strong>ä½œç”¨ï¼š</strong>å¢å¼ºæƒ…æ„Ÿ</p>
<div class="codehilite"><pre><span></span><code>&quot;Great&quot;    â†’ +3.32
&quot;Great!&quot;   â†’ +3.32 + 0.1 = +3.42
&quot;Great!!!&quot; â†’ +3.32 + 0.3 = +3.62
</code></pre></div>

<p><strong>å®ç°ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="n">exclamation_words</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;!&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;!!&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s1">&#39;!!!&#39;</span><span class="p">:</span> <span class="mf">0.3</span>
<span class="p">}</span>
</code></pre></div>

<hr />
<h3 id="6">6. å®Œæ•´ç®—æ³•</h3>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">classify_sentiment_advanced</span><span class="p">(</span><span class="n">tweet</span><span class="p">,</span> <span class="n">valence</span><span class="p">,</span>
                               <span class="n">negation_words</span><span class="p">,</span>
                               <span class="n">strengthen_words</span><span class="p">,</span>
                               <span class="n">weaken_words</span><span class="p">,</span>
                               <span class="n">exclamation_words</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    é«˜çº§æƒ…æ„Ÿåˆ†ç±»ï¼ˆè€ƒè™‘å¦å®šã€åŠ å¼ºã€å‡å¼±ç­‰ï¼‰</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">tweet</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">tweet_valence</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="c1"># åŸºç¡€æƒ…æ„Ÿåˆ†æ•°</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">valence</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">valence</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

        <span class="c1"># å¦å®šè¯</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">negation_words</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">*=</span> <span class="o">-</span><span class="mf">0.8</span>

        <span class="c1"># æ„Ÿå¹å·</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">exclamation_words</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">exclamation_words</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

        <span class="c1"># åŠ å¼ºè¯</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">strengthen_words</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">strengthen_words</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

        <span class="c1"># å‡å¼±è¯</span>
        <span class="k">if</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">weaken_words</span><span class="p">:</span>
            <span class="n">tweet_valence</span> <span class="o">+=</span> <span class="n">weaken_words</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>

    <span class="c1"># åˆ†ç±»</span>
    <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.05</span>
    <span class="k">if</span> <span class="n">tweet_valence</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;positive&#39;</span>
    <span class="k">elif</span> <span class="n">tweet_valence</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">threshold</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;negative&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;neutral&#39;</span>
</code></pre></div>

<hr />
<h2 id="_4">å››ã€è¯„ä¼°æŒ‡æ ‡</h2>
<h3 id="1-confusion-matrix">1. æ··æ·†çŸ©é˜µï¼ˆConfusion Matrixï¼‰</h3>
<p><strong>å®šä¹‰ï¼š</strong>å¯¹æ¯”çœŸå®æ ‡ç­¾å’Œé¢„æµ‹æ ‡ç­¾</p>
<div class="codehilite"><pre><span></span><code>            é¢„æµ‹
           pos  neu  neg
çœŸ  pos  [  50   10    5 ]
å®  neu  [  10  100   15 ]
    neg  [   3   12   60 ]
</code></pre></div>

<p><strong>å«ä¹‰ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>ç¬¬1è¡Œï¼šçœŸå®æ˜¯positiveçš„65ä¸ªæ ·æœ¬
  - 50ä¸ªé¢„æµ‹æ­£ç¡®ï¼ˆpos â†’ posï¼‰
  - 10ä¸ªé¢„æµ‹é”™è¯¯ï¼ˆpos â†’ neuï¼‰
  - 5ä¸ªé¢„æµ‹é”™è¯¯ï¼ˆpos â†’ negï¼‰

ç¬¬2è¡Œï¼šçœŸå®æ˜¯neutralçš„125ä¸ªæ ·æœ¬
  - 10ä¸ªé¢„æµ‹ä¸ºpos
  - 100ä¸ªé¢„æµ‹æ­£ç¡®
  - 15ä¸ªé¢„æµ‹ä¸ºneg

ç¬¬3è¡Œï¼šçœŸå®æ˜¯negativeçš„75ä¸ªæ ·æœ¬
  - 3ä¸ªé¢„æµ‹ä¸ºpos
  - 12ä¸ªé¢„æµ‹ä¸ºneu
  - 60ä¸ªé¢„æµ‹æ­£ç¡®
</code></pre></div>

<hr />
<h3 id="2-accuracy">2. å‡†ç¡®ç‡ï¼ˆAccuracyï¼‰</h3>
<p><strong>å…¬å¼ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>å‡†ç¡®ç‡ = æ­£ç¡®é¢„æµ‹çš„æ•°é‡ / æ€»æ•°é‡
       = (å¯¹è§’çº¿å…ƒç´ ä¹‹å’Œ) / (æ‰€æœ‰å…ƒç´ ä¹‹å’Œ)
</code></pre></div>

<p><strong>è®¡ç®—ç¤ºä¾‹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code>æ··æ·†çŸ©é˜µï¼š
            pos  neu  neg
       pos [50   10    5]
       neu [10  100   15]
       neg [ 3   12   60]

æ­£ç¡®é¢„æµ‹ = 50 + 100 + 60 = 210
æ€»æ•° = 65 + 125 + 75 = 265

å‡†ç¡®ç‡ = 210 / 265 = 0.792 = 79.2%
</code></pre></div>

<hr />
<h3 id="3_3">3. ä»£ç å®ç°</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># åˆå§‹åŒ–æ··æ·†çŸ©é˜µï¼ˆ3Ã—3ï¼‰</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># æƒ…æ„Ÿæ ‡ç­¾åˆ°æ•°å­—çš„æ˜ å°„</span>
<span class="k">def</span><span class="w"> </span><span class="nf">s2id</span><span class="p">(</span><span class="n">sentiment</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">sentiment</span> <span class="o">==</span> <span class="s2">&quot;positive&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">sentiment</span> <span class="o">==</span> <span class="s2">&quot;neutral&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">sentiment</span> <span class="o">==</span> <span class="s2">&quot;negative&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">2</span>

<span class="c1"># éå†æ¯æ¡æ¨æ–‡</span>
<span class="k">for</span> <span class="n">true_sentiment</span><span class="p">,</span> <span class="n">tweet</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="c1"># é¢„æµ‹æƒ…æ„Ÿ</span>
    <span class="n">pred_sentiment</span> <span class="o">=</span> <span class="n">classify_sentiment</span><span class="p">(</span><span class="n">tweet</span><span class="p">)</span>

    <span class="c1"># æ›´æ–°æ··æ·†çŸ©é˜µ</span>
    <span class="n">cm</span><span class="p">[</span><span class="n">s2id</span><span class="p">(</span><span class="n">true_sentiment</span><span class="p">)][</span><span class="n">s2id</span><span class="p">(</span><span class="n">pred_sentiment</span><span class="p">)]</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># è®¡ç®—å‡†ç¡®ç‡</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">accuracy</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># æ‰“å°æ··æ·†çŸ©é˜µ</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
</code></pre></div>

<p><strong>è¯¦ç»†è§£é‡Šï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="c1"># å‡è®¾é¢„æµ‹ç»“æœï¼š</span>
<span class="n">true_sentiment</span> <span class="o">=</span> <span class="s1">&#39;positive&#39;</span>
<span class="n">pred_sentiment</span> <span class="o">=</span> <span class="s1">&#39;neutral&#39;</span>

<span class="c1"># æ›´æ–°æ··æ·†çŸ©é˜µ</span>
<span class="n">true_id</span> <span class="o">=</span> <span class="n">s2id</span><span class="p">(</span><span class="s1">&#39;positive&#39;</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pred_id</span> <span class="o">=</span> <span class="n">s2id</span><span class="p">(</span><span class="s1">&#39;neutral&#39;</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">cm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="c1"># è¡¨ç¤ºï¼šçœŸå®æ˜¯positiveï¼Œé¢„æµ‹ä¸ºneutral</span>

<span class="c1"># æ··æ·†çŸ©é˜µçš„å«ä¹‰ï¼š</span>
<span class="c1"># cm[i][j] = çœŸå®æ ‡ç­¾ä¸ºiï¼Œé¢„æµ‹æ ‡ç­¾ä¸ºjçš„æ•°é‡</span>

<span class="c1"># np.trace(cm)ï¼šå¯¹è§’çº¿å…ƒç´ ä¹‹å’Œ</span>
<span class="c1"># ä¾‹å¦‚ï¼šcm[0][0] + cm[1][1] + cm[2][2]</span>
<span class="c1"># è¿™äº›æ˜¯é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬</span>

<span class="c1"># np.sum(cm)ï¼šæ‰€æœ‰å…ƒç´ ä¹‹å’Œï¼ˆæ€»æ ·æœ¬æ•°ï¼‰</span>
</code></pre></div>

<hr />
<h2 id="_5">äº”ã€å®Œæ•´æ‰§è¡Œæµç¨‹</h2>
<h3 id="pmi_1">PMIæ–¹æ³•æµç¨‹</h3>
<div class="codehilite"><pre><span></span><code>æ­¥éª¤1ï¼šå‡†å¤‡æ•°æ®
  â”œâ”€ è¯»å–tweets CSVæ–‡ä»¶
  â”œâ”€ è½¬å°å†™
  â””â”€ å®šä¹‰ç§¯æè¯ã€æ¶ˆæè¯ã€ç›®æ ‡å…¬å¸

æ­¥éª¤2ï¼šç»Ÿè®¡è¯é¢‘
  â”œâ”€ ç»Ÿè®¡æ¯ä¸ªè¯çš„å‡ºç°æ¬¡æ•°ï¼ˆocc_countsï¼‰
  â””â”€ ç»Ÿè®¡å…¬å¸å’Œæƒ…æ„Ÿè¯çš„å…±ç°æ¬¡æ•°ï¼ˆcooc_countsï¼‰

æ­¥éª¤3ï¼šè®¡ç®—PMI
  â”œâ”€ å¯¹æ¯ä¸ªå…¬å¸
  â”‚  â”œâ”€ è®¡ç®—å’Œç§¯æè¯çš„PMI
  â”‚  â””â”€ è®¡ç®—å’Œæ¶ˆæè¯çš„PMI
  â””â”€ æ±‚å¹³å‡å€¼

æ­¥éª¤4ï¼šåˆ¤æ–­æƒ…æ„Ÿ
  â””â”€ æ¯”è¾ƒavg_poså’Œavg_neg
</code></pre></div>

<hr />
<h3 id="_6">å¯è¯„åˆ†æ–¹æ³•æµç¨‹</h3>
<div class="codehilite"><pre><span></span><code>æ­¥éª¤1ï¼šå‡†å¤‡æ•°æ®
  â”œâ”€ è¯»å–tweets CSVæ–‡ä»¶
  â”œâ”€ è¯»å–æƒ…æ„Ÿè¯å…¸
  â””â”€ è¯»å–å¦å®šè¯ã€åŠ å¼ºè¯ç­‰åˆ—è¡¨

æ­¥éª¤2ï¼šå¯¹æ¯æ¡æ¨æ–‡
  â”œâ”€ åˆ†è¯
  â”œâ”€ ç´¯åŠ æƒ…æ„Ÿåˆ†æ•°
  â”œâ”€ å¤„ç†å¦å®šã€åŠ å¼ºã€å‡å¼±ç­‰
  â””â”€ æ ¹æ®é˜ˆå€¼åˆ†ç±»

æ­¥éª¤3ï¼šè¯„ä¼°
  â”œâ”€ æ„å»ºæ··æ·†çŸ©é˜µ
  â”œâ”€ è®¡ç®—å‡†ç¡®ç‡
  â””â”€ å¯è§†åŒ–ç»“æœ
</code></pre></div>

<hr />
<h2 id="_7">å…­ã€ä¸¤ç§æ–¹æ³•çš„å¯¹æ¯”</h2>
<h3 id="pmi_2">PMIæ–¹æ³•</h3>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">æ— éœ€äººå·¥æ ‡æ³¨è¯å…¸</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">èƒ½å‘ç°æ„æƒ³ä¸åˆ°çš„å…³è”</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">é€‚åˆåˆ†ææ•´ä½“æƒ…æ„Ÿ</span><span class="err">ï¼ˆ</span><span class="n">å…¬å¸</span><span class="err">ã€</span><span class="n">äº§å“ç­‰</span><span class="err">ï¼‰</span>
</code></pre></div>

<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">éœ€è¦å¤§é‡æ•°æ®</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">åªèƒ½åˆ¤æ–­æ•´ä½“</span><span class="err">ï¼Œ</span><span class="n">ä¸èƒ½é€å¥åˆ†ç±»</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">ä¾èµ–ç§å­è¯</span><span class="err">ï¼ˆ</span><span class="n">ç§¯æè¯å’Œæ¶ˆæè¯åˆ—è¡¨</span><span class="err">ï¼‰</span>
</code></pre></div>

<hr />
<h3 id="_8">å¯è¯„åˆ†æ–¹æ³•</h3>
<p><strong>ä¼˜ç‚¹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">å¯ä»¥å¯¹æ¯æ¡æ¨æ–‡åˆ†ç±»</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">å¯ä»¥å¤„ç†å¤æ‚è¯­è¨€ç°è±¡</span><span class="err">ï¼ˆ</span><span class="n">å¦å®š</span><span class="err">ã€</span><span class="n">åŠ å¼ºç­‰</span><span class="err">ï¼‰</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">ç»“æœå¯è§£é‡Š</span><span class="err">ï¼ˆ</span><span class="n">å¯ä»¥çœ‹æ¯ä¸ªè¯çš„è´¡çŒ®</span><span class="err">ï¼‰</span>
</code></pre></div>

<p><strong>ç¼ºç‚¹ï¼š</strong></p>
<div class="codehilite"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">éœ€è¦äººå·¥æ ‡æ³¨çš„æƒ…æ„Ÿè¯å…¸</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">è¯å…¸è¦†ç›–ä¸å…¨çš„è¯æ— æ³•å¤„ç†</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">ç®€å•ç›¸åŠ å¯èƒ½ä¸å‡†ç¡®</span>
</code></pre></div>

<hr />
<h2 id="_9">ä¸ƒã€çº¸ç¬”è€ƒè¯•é‡ç‚¹</h2>
<h3 id="_10">å¿…é¡»æŒæ¡</h3>
<h4 id="1-pmi_1">1. âœ… <strong>PMIçš„å®šä¹‰å’Œè®¡ç®—</strong></h4>
<div class="codehilite"><pre><span></span><code>å…¬å¼ï¼š
PMI(x,y) = logâ‚‚( P(x,y) / (P(x) Ã— P(y)) )
        = logâ‚‚( (C(x,y) Ã— N) / (C(x) Ã— C(y)) )

èƒ½æ‰‹å·¥è®¡ç®—ç»™å®šæ•°æ®çš„PMIå€¼
</code></pre></div>

<h4 id="2-pmi_1">2. âœ… <strong>PMIå€¼çš„æ„ä¹‰</strong></h4>
<div class="codehilite"><pre><span></span><code>PMI &gt; 0ï¼šæ­£ç›¸å…³ï¼ˆä¸€èµ·å‡ºç°æ¯”éšæœºå¤šï¼‰
PMI = 0ï¼šä¸ç›¸å…³
PMI &lt; 0ï¼šè´Ÿç›¸å…³ï¼ˆä¸€èµ·å‡ºç°æ¯”éšæœºå°‘ï¼‰
</code></pre></div>

<h4 id="3_4">3. âœ… <strong>å¯è¯„åˆ†æ–¹æ³•çš„åŸç†</strong></h4>
<div class="codehilite"><pre><span></span><code>å¥å­æƒ…æ„Ÿ = Î£ è¯çš„æƒ…æ„Ÿåˆ†æ•°
æ ¹æ®é˜ˆå€¼åˆ†ç±»ä¸ºpositive/neutral/negative
</code></pre></div>

<h4 id="4_2">4. âœ… <strong>æ··æ·†çŸ©é˜µ</strong></h4>
<div class="codehilite"><pre><span></span><code>èƒ½è¯»æ‡‚æ··æ·†çŸ©é˜µ
èƒ½è®¡ç®—å‡†ç¡®ç‡ = å¯¹è§’çº¿ä¹‹å’Œ / æ€»å’Œ
</code></pre></div>

<h4 id="5_2">5. âœ… <strong>ç‰¹æ®Šè¯çš„å¤„ç†</strong></h4>
<div class="codehilite"><pre><span></span><code>å¦å®šè¯ï¼šåè½¬æƒ…æ„Ÿ
åŠ å¼ºè¯ï¼šå¢å¼ºæƒ…æ„Ÿ
å‡å¼±è¯ï¼šå‡å¼±æƒ…æ„Ÿ
æ„Ÿå¹å·ï¼šå¢å¼ºæƒ…æ„Ÿ
</code></pre></div>

<hr />
<h3 id="_11">å¯èƒ½çš„è€ƒé¢˜</h3>
<h4 id="1pmi_1">é¢˜å‹1ï¼šè®¡ç®—PMI</h4>
<p><strong>é¢˜ç›®ï¼š</strong>ç»™å®šä»¥ä¸‹æ•°æ®ï¼Œè®¡ç®—PMI(excellent, restaurant)</p>
<div class="codehilite"><pre><span></span><code>æ€»æ¨æ–‡æ•°ï¼šN = 10,000
&quot;excellent&quot; å‡ºç°ï¼š500æ¬¡
&quot;restaurant&quot; å‡ºç°ï¼š1,000æ¬¡
ä¸¤è€…å…±ç°ï¼š150æ¬¡
</code></pre></div>

<details>
<summary>ç­”æ¡ˆ</summary>


<div class="codehilite"><pre><span></span><code>C(excellent) = 500
C(restaurant) = 1,000
C(excellent, restaurant) = 150
N = 10,000

PMI = logâ‚‚( (C(x,y) Ã— N) / (C(x) Ã— C(y)) )
    = logâ‚‚( (150 Ã— 10,000) / (500 Ã— 1,000) )
    = logâ‚‚( 1,500,000 / 500,000 )
    = logâ‚‚( 3 )
    â‰ˆ 1.585
</code></pre></div>



**è§£é‡Šï¼š**PMI = 1.585 > 0ï¼Œè¯´æ˜"excellent"å’Œ"restaurant"æ­£ç›¸å…³
</details>

<hr />
<h4 id="2pmi">é¢˜å‹2ï¼šPMIçš„æ„ä¹‰</h4>
<p><strong>é¢˜ç›®ï¼š</strong>è§£é‡Šä»¥ä¸‹PMIå€¼çš„å«ä¹‰</p>
<div class="codehilite"><pre><span></span><code><span class="n">PMI</span><span class="p">(</span><span class="n">love</span><span class="p">,</span><span class="w"> </span><span class="nv">@JetBlue</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.5</span>
<span class="n">PMI</span><span class="p">(</span><span class="n">hate</span><span class="p">,</span><span class="w"> </span><span class="nv">@JetBlue</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">0.5</span>
</code></pre></div>

<details>
<summary>ç­”æ¡ˆ</summary>

**PMI(love, @JetBlue) = 2.5 > 0ï¼š**
- "love"å’Œ"@JetBlue"æ­£ç›¸å…³
- å®ƒä»¬ä¸€èµ·å‡ºç°çš„é¢‘ç‡ï¼Œè¿œé«˜äºéšæœºæƒ…å†µ
- è¯´æ˜äººä»¬ç»å¸¸åœ¨æåˆ°@JetBlueæ—¶ä½¿ç”¨"love"
- æš—ç¤º@JetBlueæœ‰ç§¯æè¯„ä»·

**PMI(hate, @JetBlue) = -0.5 < 0ï¼š**
- "hate"å’Œ"@JetBlue"è´Ÿç›¸å…³
- å®ƒä»¬ä¸€èµ·å‡ºç°çš„é¢‘ç‡ï¼Œä½äºéšæœºæƒ…å†µ
- è¯´æ˜äººä»¬åœ¨æåˆ°@JetBlueæ—¶å¾ˆå°‘ä½¿ç”¨"hate"
- è¿›ä¸€æ­¥æ”¯æŒ@JetBlueè¯„ä»·ç§¯æçš„ç»“è®º

**ç»¼åˆåˆ¤æ–­ï¼š**
- ç§¯æPMIï¼ˆ2.5ï¼‰è¿œå¤§äºæ¶ˆæPMIï¼ˆ-0.5ï¼‰
- @JetBlueçš„æ•´ä½“æƒ…æ„Ÿæ˜¯ç§¯æçš„
</details>

<hr />
<h4 id="3_5">é¢˜å‹3ï¼šå¯è¯„åˆ†æ–¹æ³•åˆ†ç±»</h4>
<p><strong>é¢˜ç›®ï¼š</strong>ä½¿ç”¨å¯è¯„åˆ†æ–¹æ³•å¯¹ä»¥ä¸‹æ¨æ–‡åˆ†ç±»</p>
<div class="codehilite"><pre><span></span><code>æ¨æ–‡ï¼š&quot;I really love this airline!&quot;
æƒ…æ„Ÿè¯å…¸ï¼š
  love â†’ +3.0
  really â†’ +0.5ï¼ˆåŠ å¼ºè¯ï¼‰
  ! â†’ +0.1ï¼ˆæ„Ÿå¹å·ï¼‰

é˜ˆå€¼ï¼šthreshold = 0.5
</code></pre></div>

<details>
<summary>ç­”æ¡ˆ</summary>


<div class="codehilite"><pre><span></span><code>åˆ†è¯ï¼š[&#39;i&#39;, &#39;really&#39;, &#39;love&#39;, &#39;this&#39;, &#39;airline&#39;, &#39;!&#39;]

è®¡ç®—æƒ…æ„Ÿåˆ†æ•°ï¼š
tweet_valence = 0
<span class="k">-</span> &#39;i&#39; â†’ ä¸åœ¨è¯å…¸ï¼Œè·³è¿‡
<span class="k">-</span> &#39;really&#39; â†’ åŠ å¼ºè¯ï¼Œtweet_valence += 0.5 = 0.5
<span class="k">-</span> &#39;love&#39; â†’ æƒ…æ„Ÿè¯ï¼Œtweet_valence += 3.0 = 3.5
<span class="k">-</span> &#39;this&#39; â†’ ä¸åœ¨è¯å…¸ï¼Œè·³è¿‡
<span class="k">-</span> &#39;airline&#39; â†’ ä¸åœ¨è¯å…¸ï¼Œè·³è¿‡
<span class="k">-</span> &#39;!&#39; â†’ æ„Ÿå¹å·ï¼Œtweet_valence += 0.1 = 3.6

æœ€ç»ˆï¼štweet_valence = 3.6

åˆ†ç±»ï¼š
threshold = 0.5
3.6 &gt; 0.5  # True
â†’ åˆ†ç±»ä¸º &#39;positive&#39;
</code></pre></div>


</details>

<hr />
<h4 id="4_3">é¢˜å‹4ï¼šå¦å®šè¯å¤„ç†</h4>
<p><strong>é¢˜ç›®ï¼š</strong>è€ƒè™‘å¦å®šè¯åï¼Œä»¥ä¸‹æ¨æ–‡åº”è¯¥åˆ†ç±»ä¸ºä»€ä¹ˆï¼Ÿ</p>
<div class="codehilite"><pre><span></span><code>æ¨æ–‡ï¼š&quot;I don&#39;t hate it&quot;
æƒ…æ„Ÿè¯å…¸ï¼š
  hate â†’ -3.0
å¦å®šè¯åˆ—è¡¨ï¼š[&quot;don&#39;t&quot;]
å¦å®šè§„åˆ™ï¼šé‡åˆ°å¦å®šè¯ï¼Œå°†åç»­æƒ…æ„Ÿåˆ†æ•°ä¹˜ä»¥-0.8

é˜ˆå€¼ï¼šthreshold = 0.5
</code></pre></div>

<details>
<summary>ç­”æ¡ˆ</summary>

**æ–¹æ³•1ï¼šç®€å•å®ç°ï¼ˆä¸å‡†ç¡®ï¼‰**

<div class="codehilite"><pre><span></span><code>tweet_valence = 0
<span class="k">-</span> &#39;i&#39; â†’ è·³è¿‡
<span class="k">-</span> &quot;don&#39;t&quot; â†’ å¦å®šè¯ï¼Œtweet_valence *= -0.8 = 0
<span class="k">-</span> &#39;hate&#39; â†’ tweet_valence += (-3.0) = -3.0
<span class="k">-</span> &#39;it&#39; â†’ è·³è¿‡

tweet_valence = -3.0
â†’ åˆ†ç±»ä¸º &#39;negative&#39;ï¼ˆé”™è¯¯ï¼ï¼‰
</code></pre></div>



**æ–¹æ³•2ï¼šæ­£ç¡®å®ç°**

<div class="codehilite"><pre><span></span><code>tweet_valence = 0
negation_flag = False

<span class="k">-</span> &#39;i&#39; â†’ è·³è¿‡
<span class="k">-</span> &quot;don&#39;t&quot; â†’ negation_flag = True
<span class="k">-</span> &#39;hate&#39; â†’
  if negation_flag:
    tweet_valence += -(-3.0) * 0.8 = +2.4
  å¦å®šåè½¬ï¼šhateæ˜¯è´Ÿé¢ï¼Œå¦å®šåå˜æ­£é¢
<span class="k">-</span> &#39;it&#39; â†’ è·³è¿‡

tweet_valence = 2.4
2.4 &gt; 0.5
â†’ åˆ†ç±»ä¸º &#39;positive&#39;ï¼ˆæ­£ç¡®ï¼ï¼‰

è§£é‡Šï¼š&quot;ä¸è®¨åŒ&quot;è¡¨ç¤º&quot;è¿˜ä¸é”™&quot;ï¼Œæ˜¯æ­£é¢æƒ…æ„Ÿ
</code></pre></div>


</details>

<hr />
<h4 id="5_3">é¢˜å‹5ï¼šæ··æ·†çŸ©é˜µå’Œå‡†ç¡®ç‡</h4>
<p><strong>é¢˜ç›®ï¼š</strong>ç»™å®šæ··æ·†çŸ©é˜µï¼Œè®¡ç®—å‡†ç¡®ç‡</p>
<div class="codehilite"><pre><span></span><code>           é¢„æµ‹
         pos neu neg
çœŸ  pos [ 40  10   5]
å®  neu [  5  80  10]
    neg [  2   8  50]
</code></pre></div>

<details>
<summary>ç­”æ¡ˆ</summary>


<div class="codehilite"><pre><span></span><code>å‡†ç¡®ç‡ = å¯¹è§’çº¿ä¹‹å’Œ / æ€»å’Œ
       = (40 + 80 + 50) / (æ‰€æœ‰å…ƒç´ ä¹‹å’Œ)

æ€»å’Œ = 40+10+5 + 5+80+10 + 2+8+50
     = 55 + 95 + 60
     = 210

å‡†ç¡®ç‡ = 170 / 210
       = 0.810
       = 81.0%
</code></pre></div>



**é¢å¤–åˆ†æï¼š**

<div class="codehilite"><pre><span></span><code>Positiveç±»åˆ«ï¼š
  çœŸå®55ä¸ªï¼Œé¢„æµ‹æ­£ç¡®40ä¸ª
  å‡†ç¡®ç‡ = 40/55 = 72.7%

Neutralç±»åˆ«ï¼š
  çœŸå®95ä¸ªï¼Œé¢„æµ‹æ­£ç¡®80ä¸ª
  å‡†ç¡®ç‡ = 80/95 = 84.2%

Negativeç±»åˆ«ï¼š
  çœŸå®60ä¸ªï¼Œé¢„æµ‹æ­£ç¡®50ä¸ª
  å‡†ç¡®ç‡ = 50/60 = 83.3%

è§‚å¯Ÿï¼šNeutralå’ŒNegativeé¢„æµ‹è¾ƒå¥½ï¼ŒPositiveè¾ƒå·®
</code></pre></div>


</details>

<hr />
<h2 id="python">å…«ã€Pythonåº“å’Œå‡½æ•°</h2>
<h3 id="1-collections">1. Collections</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>

<span class="c1"># Counterï¼šè®¡æ•°å­—å…¸</span>
<span class="n">counter</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">])</span>
<span class="c1"># Counter({&#39;a&#39;: 3, &#39;b&#39;: 2, &#39;c&#39;: 1})</span>

<span class="n">counter</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># [(&#39;a&#39;, 3), (&#39;b&#39;, 2)]  â† è¿”å›æœ€å¸¸è§çš„2ä¸ª</span>

<span class="c1"># defaultdictï¼šé»˜è®¤å€¼å­—å…¸</span>
<span class="n">dd</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span>
<span class="n">dd</span><span class="p">[</span><span class="s1">&#39;key1&#39;</span><span class="p">][</span><span class="s1">&#39;subkey&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># è‡ªåŠ¨åˆ›å»ºCounter</span>
</code></pre></div>

<hr />
<h3 id="2-pandas">2. Pandas</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="c1"># è¯»å–CSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.csv&quot;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># è¯»å–TSV</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;file.tsv&quot;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># è½¬å°å†™</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="c1"># éå†</span>
<span class="k">for</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>

<span class="c1"># è½¬å­—å…¸</span>
<span class="n">valence</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Valence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
</code></pre></div>

<hr />
<h3 id="3-numpy">3. NumPy</h3>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="c1"># å¯¹æ•°</span>
<span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>  <span class="c1"># 3.0</span>

<span class="c1"># çŸ©é˜µ</span>
<span class="n">matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>  <span class="c1"># 3Ã—3é›¶çŸ©é˜µ</span>

<span class="c1"># å¯¹è§’çº¿ä¹‹å’Œ</span>
<span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

<span class="c1"># æ‰€æœ‰å…ƒç´ ä¹‹å’Œ</span>
<span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

<span class="c1"># å¹³å‡å€¼</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>  <span class="c1"># 2.0</span>
</code></pre></div>

<hr />
<h2 id="_12">ä¹ã€è®°å¿†å£è¯€</h2>
<h3 id="pmi_3">PMIæ–¹æ³•</h3>
<div class="codehilite"><pre><span></span><code>å…±ç°é¢‘ç‡çœ‹å…³è”ï¼Œ
PMIè®¡ç®—è¦è®°å…¨ï¼Œ
å¯¹æ•°å…¬å¼è«ææ··ï¼Œ
æ­£è´Ÿé›¶å€¼åˆ†å¾—æ¸…ã€‚
</code></pre></div>

<h3 id="_13">å¯è¯„åˆ†æ–¹æ³•</h3>
<div class="codehilite"><pre><span></span><code>è¯å…¸åˆ†æ•°æ¥åˆ¤æ–­ï¼Œ
é˜ˆå€¼è®¾ç½®å¾ˆå…³é”®ï¼Œ
å¦å®šåè½¬è¦æ³¨æ„ï¼Œ
åŠ å¼ºå‡å¼±åˆ«å¿˜è®°ã€‚
</code></pre></div>

<h3 id="_14">æ··æ·†çŸ©é˜µ</h3>
<div class="codehilite"><pre><span></span><code>å¯¹è§’çº¿ä¸Šæ˜¯æ­£ç¡®ï¼Œ
å…¶ä»–æ ¼å­æ˜¯é”™è¯¯ï¼Œ
æ€»å’Œä¸€é™¤å¾—å‡†ç¡®ï¼Œ
ä¸‰ç±»åˆ†å¼€ç®—ç²¾åº¦ã€‚
</code></pre></div>

<hr />
<h2 id="_15">åã€å¸¸è§é”™è¯¯</h2>
<h3 id="1pmi_2">âŒ é”™è¯¯1ï¼šPMIè®¡ç®—å…¬å¼é”™è¯¯</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># é”™è¯¯</span>
<span class="n">PMI</span> <span class="o">=</span> <span class="n">log</span><span class="p">(</span><span class="n">c_xy</span> <span class="o">/</span> <span class="p">(</span><span class="n">c_x</span> <span class="o">*</span> <span class="n">c_y</span><span class="p">))</span>  <span class="err">âŒ</span>
<span class="c1"># å¿˜è®°ä¹˜Nï¼Œå¿˜è®°logçš„åº•æ•°</span>

<span class="c1"># æ­£ç¡®</span>
<span class="n">PMI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">((</span><span class="n">c_xy</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">c_x</span> <span class="o">*</span> <span class="n">c_y</span><span class="p">))</span>  <span class="err">âœ…</span>
</code></pre></div>

<hr />
<h3 id="2_1">âŒ é”™è¯¯2ï¼šå…±ç°ç»Ÿè®¡ä¸å»é‡</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># é”™è¯¯</span>
<span class="n">tweet</span> <span class="o">=</span> <span class="s2">&quot;I love love love @jetblue&quot;</span>
<span class="n">words</span> <span class="o">=</span> <span class="n">tweet</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>  <span class="c1"># [&#39;I&#39;, &#39;love&#39;, &#39;love&#39;, &#39;love&#39;, &#39;@jetblue&#39;]</span>
<span class="c1"># loveå’Œ@jetblueå…±ç°3æ¬¡ï¼ŸâŒ</span>

<span class="c1"># æ­£ç¡®</span>
<span class="n">words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">tweet</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>  <span class="c1"># {&#39;I&#39;, &#39;love&#39;, &#39;@jetblue&#39;}</span>
<span class="c1"># loveå’Œ@jetblueå…±ç°1æ¬¡âœ…</span>
<span class="c1"># å› ä¸ºæˆ‘ä»¬åªå…³å¿ƒæ˜¯å¦åœ¨åŒä¸€æ¡æ¨æ–‡ä¸­ï¼Œä¸å…³å¿ƒå‡ºç°å‡ æ¬¡</span>
</code></pre></div>

<hr />
<h3 id="3_6">âŒ é”™è¯¯3ï¼šé˜ˆå€¼è®¾ç½®ä¸åˆç†</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># ä¸åˆç†</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># å¤ªå°ï¼Œæ²¡æœ‰neutral</span>
<span class="c1"># æ‰€æœ‰æ¥è¿‘0çš„éƒ½è¢«åˆ†ä¸ºpositiveæˆ–negative</span>

<span class="n">threshold</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># å¤ªå¤§ï¼Œå…¨æ˜¯neutral</span>
<span class="c1"># åªæœ‰æç«¯æƒ…æ„Ÿæ‰è¢«åˆ†ç±»</span>

<span class="c1"># åˆç†</span>
<span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># é€‚ä¸­</span>
<span class="c1"># ç»™neutralç•™æœ‰ç©ºé—´ï¼Œåˆä¸è‡³äºå¤ªå®½</span>
</code></pre></div>

<hr />
<h3 id="4_4">âŒ é”™è¯¯4ï¼šæ··æ·†çŸ©é˜µè¡Œåˆ—æå</h3>
<div class="codehilite"><pre><span></span><code><span class="c1"># é”™è¯¯</span>
<span class="n">cm</span><span class="p">[</span><span class="n">pred_id</span><span class="p">][</span><span class="n">true_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="err">âŒ</span>
<span class="c1"># é¢„æµ‹åœ¨è¡Œï¼ŒçœŸå®åœ¨åˆ—ï¼ˆåäº†ï¼ï¼‰</span>

<span class="c1"># æ­£ç¡®</span>
<span class="n">cm</span><span class="p">[</span><span class="n">true_id</span><span class="p">][</span><span class="n">pred_id</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="err">âœ…</span>
<span class="c1"># çœŸå®åœ¨è¡Œï¼Œé¢„æµ‹åœ¨åˆ—</span>

<span class="c1"># è®°å¿†ï¼šTrue Realï¼ˆçœŸå®åœ¨è¡Œï¼‰</span>
</code></pre></div>

<hr />
<h2 id="_16">åä¸€ã€æ‰©å±•åº”ç”¨</h2>
<h3 id="1_2">1. å¤šåˆ†ç±»æƒ…æ„Ÿåˆ†æ</h3>
<div class="codehilite"><pre><span></span><code>é™¤äº†positive/neutral/negativeï¼Œè¿˜å¯ä»¥ï¼š
- 5åˆ†ç±»ï¼švery negative, negative, neutral, positive, very positive
- æƒ…ç»ªåˆ†ç±»ï¼šhappy, sad, angry, fearful, surprised
</code></pre></div>

<hr />
<h3 id="2-aspect-based-sentiment">2. æ–¹é¢æƒ…æ„Ÿåˆ†æï¼ˆAspect-Based Sentimentï¼‰</h3>
<div class="codehilite"><pre><span></span><code>ä¸åªåˆ¤æ–­æ•´ä½“æƒ…æ„Ÿï¼Œè¿˜è¦åˆ¤æ–­å¯¹å…·ä½“æ–¹é¢çš„æƒ…æ„Ÿ

ä¾‹å¦‚é¤å…è¯„è®ºï¼š
&quot;The food is excellent but the service is terrible&quot;
â†’ food: positive
â†’ service: negative
</code></pre></div>

<hr />
<h3 id="3_7">3. å®æ—¶æƒ…æ„Ÿç›‘æ§</h3>
<div class="codehilite"><pre><span></span><code>åº”ç”¨ï¼š
1. ç›‘æ§å“ç‰Œå£°èª‰
2. è·Ÿè¸ªäº§å“å‘å¸ƒååº”
3. é¢„è­¦å…¬å…³å±æœº
</code></pre></div>

<hr />
<p><strong>ç¥ä½ è€ƒè¯•é¡ºåˆ©ï¼</strong> ğŸ‰</p>
<p><strong>Lecture 6æ ¸å¿ƒè¦ç‚¹ï¼š</strong>
- PMIå…¬å¼ï¼š<code>logâ‚‚(C(x,y)Ã—N / (C(x)Ã—C(y)))</code>
- PMI &gt; 0æ­£ç›¸å…³ï¼Œ&lt; 0è´Ÿç›¸å…³
- å¯è¯„åˆ†æ–¹æ³•ï¼šç´¯åŠ è¯çš„æƒ…æ„Ÿåˆ†æ•°
- é˜ˆå€¼åˆ†ç±»ï¼špositive &gt; threshold, negative &lt; -threshold
- å¦å®šè¯åè½¬æƒ…æ„Ÿ
- æ··æ·†çŸ©é˜µè¯„ä¼°ï¼šå‡†ç¡®ç‡ = å¯¹è§’çº¿å’Œ/æ€»å’Œ</p>
<p><strong>è®°ä½ï¼š</strong>ç†è§£PMIçš„æ•°å­¦å«ä¹‰ï¼Œä¼šæ‰‹å·¥è®¡ç®—ï¼ç†è§£å¦å®šã€åŠ å¼ºç­‰è¯­è¨€ç°è±¡çš„å¤„ç†æ–¹æ³•ï¼</p>
    </div>
</body>
</html>